(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"6a6f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("profile-header"),s("div",{staticClass:"q-py-lg"},[s("q-dialog",{attrs:{position:"bottom","full-width":""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("q-card",[s("q-card-section",[s("div",{staticClass:"q-py-md"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"Delete"},on:{click:t.deleteChat}})],1),s("div",{staticClass:"q-py-md"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"Cancel"},on:{click:function(e){t.dialog=!1}}})],1)])],1)],1),s("div",{staticClass:"col-12 col-lg-4 offset-lg-4 col-md-4 offset-md-4"},[s("q-input",{attrs:{rounded:"",outlined:"",placeholder:"Search",dense:"dense"},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),s("div",{staticClass:"q-pa-xs q-gutter-md"},t._l(t.chats,(function(e){return s("div",{key:e.id},["1"===t.getDoctorProfile.status?s("div",[s("div",{staticClass:"row col-12",class:1===e.doctor_unread_status?"text-green":"",on:{click:function(a){return t.$router.push({name:"chat",params:{user_id:e.patient_info.app_user_id,user:e.patient_info,last_message_id:e.id}})}}},[s("div",{staticClass:"col-3 column justify-center"},[s("q-avatar",{attrs:{size:"60px"}},[e.online_status.online_status?s("q-badge",{attrs:{rounded:"",floating:"",color:"green","text-color":"green",label:"1"}}):s("q-badge",{attrs:{rounded:"",floating:"",color:"black","text-color":"black",label:"0"}}),e.patient_info.profile_image?s("img",{attrs:{src:t.getFile(e.patient_info.profile_image)}}):s("img",{attrs:{src:a("a472")}})],1)],1),s("div",{staticClass:"col-8"},[s("div",{staticClass:"text-h6"},[t._v(t._s(e.patient_info.name))]),s("div",[t._v(t._s(e.last_message))])]),s("div",{staticClass:"col-1 column justify-center",on:{click:function(a){return t.confirm(e.app_user_patient_id)}}},[s("q-btn",{attrs:{flat:"",icon:"more_vert"}})],1)])]):t._e(),"2"===t.getDoctorProfile.status?s("div",[s("div",{staticClass:"row col-12",class:1===e.patient_unread_status?"text-green":""},[s("div",{staticClass:"col-3 column justify-center",on:{click:function(a){return t.$router.push({name:"chat",params:{user_id:e.doctor_info.app_user_id,user:e.doctor_info,last_message_id:e.id}})}}},[s("q-avatar",{attrs:{size:"60px"}},[e.online_status.online_status?s("q-badge",{attrs:{rounded:"",floating:"",color:"green","text-color":"green",label:"1"}}):s("q-badge",{attrs:{rounded:"",floating:"",color:"black","text-color":"black",label:"0"}}),e.doctor_info.profile_image?s("img",{attrs:{src:t.getFile(e.doctor_info.profile_image.profile_picture)}}):s("img",{attrs:{src:a("a472")}})],1)],1),s("div",{staticClass:"col-8",on:{click:function(a){return t.$router.push({name:"chat",params:{user_id:e.doctor_info.app_user_id,user:e.doctor_info,last_message_id:e.id}})}}},[e.doctor_info.hide_my_info?s("div",{staticClass:"text-h6"},[t._v("\n              EZCare Doctor "+t._s(new Intl.NumberFormat("en",{minimumIntegerDigits:3,minimumSignificantDigits:1,useGrouping:!1}).format(e.doctor_info.id))+"\n            ")]):s("div",{staticClass:"text-h6"},[t._v("\n              "+t._s(e.doctor_info.name)+"\n            ")]),s("div",{staticClass:"last_message"},[t._v(t._s(e.last_message))])]),s("div",{staticClass:"col-1 column justify-center",on:{click:function(a){return t.confirm(e.app_user_doctor_id)}}},[s("q-btn",{attrs:{flat:"",icon:"more_vert"}})],1)])]):t._e()])})),0)],1)},i=[],o=a("ded3"),r=a.n(o),n=a("2f62"),c=a("cafa"),l=a("812a"),d={name:"Chat",components:{ProfileHeader:l["a"]},data(){return{chats:[],chat_user_id:"",search:"",message:"",dialog:!1,last_message_id:this.$route.params.last_message_id}},computed:r()({},Object(n["b"])({getDoctorProfile:"doctor/getDoctorProfile",getDoctorToken:"doctor/getDoctorToken"})),async created(){this.getDoctorProfile.app_user_id||await this.$store.dispatch("doctor/profile"),await this.getChat(),await this.subscribe()},methods:{getFile(t){return`${c["a"].SERVER_MEDIA}${t}`},async getChat(){this.$api.defaults.headers.Authorization=`Bearer ${this.getDoctorToken}`,"1"===this.getDoctorProfile.status&&await this.$api.get("last_message_list").then((t=>{this.chats=t.data.data})),"2"===this.getDoctorProfile.status&&await this.$api.get("patient_last_message_list").then((t=>{this.chats=t.data.data}))},confirm(t){this.chat_user_id=t,this.dialog=!0},async deleteChat(){await this.$api.delete(`chat_delete_whole_conversation?receiver_id=${this.chat_user_id}`).then((t=>{this.getChat(),this.dialog=!1}))},async subscribe(){this.$root.$on("pusher_member_added",(t=>{if("1"===this.getDoctorProfile.status&&2===t.info.doctor_status){const e=this.chats.filter((e=>e.app_user_patient_id===t.info.id));e.length&&(e[0].online_status.online_status=1)}if("2"===this.getDoctorProfile.status&&1===t.info.doctor_status){const e=this.chats.filter((e=>e.app_user_doctor_id===t.info.id));e.length&&(e[0].online_status.online_status=1)}})),this.$root.$on("pusher_member_removed",(t=>{if("1"===this.getDoctorProfile.status&&2===t.info.doctor_status){const e=this.chats.filter((e=>e.app_user_patient_id===t.info.id));e.length&&(e[0].online_status.online_status=0)}if("2"===this.getDoctorProfile.status&&1===t.info.doctor_status){const e=this.chats.filter((e=>e.app_user_doctor_id===t.info.id));e.length&&(e[0].online_status.online_status=0)}}))}}},u=d,_=(a("7746"),a("2877")),f=a("9989"),h=a("24e8"),p=a("f09f"),g=a("a370"),m=a("9c40"),b=a("27f9"),v=a("0016"),C=a("cb32"),q=a("58a81"),k=a("c294"),D=a("72db"),$=a("eebe"),w=a.n($),x=Object(_["a"])(u,s,i,!1,null,"258c1072",null);e["default"]=x.exports;w()(x,"components",{QPage:f["a"],QDialog:h["a"],QCard:p["a"],QCardSection:g["a"],QBtn:m["a"],QInput:b["a"],QIcon:v["a"],QAvatar:C["a"],QBadge:q["a"],QFab:k["a"],QFabAction:D["a"]})},7746:function(t,e,a){"use strict";a("faea")},"812a":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-header",{staticClass:"bg-grey-2 text-red",attrs:{elevated:""}},[a("q-toolbar",[a("div",{staticClass:"col-1"},["/"!==t.$route.fullPath?a("q-btn",{staticClass:"q-mr-sm",attrs:{flat:"",round:"",dense:"",icon:"west"},on:{click:function(e){return t.$router.go(-1)}}}):t._e()],1),a("div",{staticClass:"col-10"},[a("div",{staticClass:"absolute-center"},[a("q-toolbar-title",{staticClass:"text-red"},[t._v("\n          EZ Care\n        ")])],1)])]),a("q-toolbar",{staticClass:"q-pa-md",attrs:{inset:""}})],1)},i=[],o={data(){return{}}},r=o,n=a("2877"),c=a("e359"),l=a("65c6"),d=a("9c40"),u=a("6ac5"),_=a("cb32"),f=a("eebe"),h=a.n(f),p=Object(n["a"])(r,s,i,!1,null,null,null);e["a"]=p.exports;h()(p,"components",{QHeader:c["a"],QToolbar:l["a"],QBtn:d["a"],QToolbarTitle:u["a"],QAvatar:_["a"]})},a472:function(t,e,a){t.exports=a.p+"img/ezcare.png"},cafa:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));const s={APP_VERSION:"0.1",SERVER_MEDIA:"http://188.166.217.32/"}},faea:function(t,e,a){}}]);